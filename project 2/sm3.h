#pragma once
#include<stdlib.h>
#include<stdio.h>
#include<iostream>
#include<chrono>
#include<intrin.h>
#include<string.h>
#include<omp.h>


#define uint_32 unsigned int// 4byte 1word
#define uint_8 unsigned char// 8bit 1byte
#define uint_256 unsigned int*
#define uint_512 unsigned int*
#define procedure 10


const uint_32 IV[8] =
{
	0x7380166f, 0x4914b2b9, 0x172442d7, 0xda8a0600, 0xa96f30bc, 0x163138aa, 0xe38dee4d, 0xb0fb0e4e
};

const uint_32 T[64] =
{
	0x79cc4519,0x79cc4519,0x79cc4519,0x79cc4519,
	0x79cc4519,0x79cc4519,0x79cc4519,0x79cc4519,
	0x79cc4519,0x79cc4519,0x79cc4519,0x79cc4519,
	0x79cc4519,0x79cc4519,0x79cc4519,0x79cc4519,

	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
	0x7a879d8a,0x7a879d8a,0x7a879d8a,0x7a879d8a,
};
const uint_32 t[64] = { 
0x79cc4519,0xf3988a32,0xe7311465,0xce6228cb,
0x9cc45197,0x3988a32f,0x7311465e,0xe6228cbc,
0xcc451979,0x988a32f3,0x311465e7,0x6228cbce,
0xc451979c,0x88a32f39,0x11465e73,0x228cbce6,
0x9d8a7a87,0x3b14f50f,0x7629ea1e,0xec53d43c,
0xd8a7a879,0xb14f50f3,0x629ea1e7,0xc53d43ce,
0x8a7a879d,0x14f50f3b,0x29ea1e76,0x53d43cec,
0xa7a879d8,0x4f50f3b1,0x9ea1e762,0x3d43cec5,
0x7a879d8a,0xf50f3b14,0xea1e7629,0xd43cec53,
0xa879d8a7,0x50f3b14f,0xa1e7629e,0x43cec53d,
0x879d8a7a,0xf3b14f5,0x1e7629ea,0x3cec53d4,
0x79d8a7a8,0xf3b14f50,0xe7629ea1,0xcec53d43,
0x9d8a7a87,0x3b14f50f,0x7629ea1e,0xec53d43c,
0xd8a7a879,0xb14f50f3,0x629ea1e7,0xc53d43ce,
0x8a7a879d,0x14f50f3b,0x29ea1e76,0x53d43cec,
0xa7a879d8,0x4f50f3b1,0x9ea1e762,0x3d43cec5 };

const unsigned int W[68] = { 0x61626380 ,0x00000000,0x00000000,0x00000000 ,0x00000000,0x00000000 ,0x00000000 ,0x00000000,
0x00000000 ,0x00000000 ,0x00000000,0x00000000,0x00000000,0x00000000 ,0x00000000 ,0x00000018,
0x9092e200,0x00000000 ,0x000c0606 ,0x719c70ed,0x00000000,0x8001801f ,0x939f7da9 ,0x00000000,
0x2c6fa1f9 ,0xadaaef14 ,0x00000000 ,0x0001801e,0x9a965f89,0x49710048 ,0x23ce86a1 ,0xb2d12f1b,
0xe1dae338 ,0xf8061807 ,0x055d68be ,0x86cfd481,0x1f447d83,0xd9023dbf ,0x185898e0 ,0xe0061807,
0x050df55c ,0xcde0104c ,0xa5b9c955 ,0xa7df0184,0x6e46cd08 ,0xe3babdf8 ,0x70caa422 ,0x0353af50,
0xa92dbca1 ,0x5f33cfd2 ,0xe16f6e89,0xf70fe941,0xca5462dc ,0x85a90152 ,0x76af6296 ,0xc922bdb2,
0x68378cf5 ,0x97585344 ,0x09008723,0x86faee74,0x2ab908b0 ,0x4a64bc50,0x864e6e08 ,0xf07e6590,
0x325c8f78 ,0xaccb8011,0xe11db9dd,0xb99c0545 };

//uint_32 FF(uint_32 X, uint_32 Y, uint_32 Z, int j);
//uint_32 GG(uint_32 X, uint_32 Y, uint_32 Z, int j);
//uint_32 P0(uint_32 arg);
//uint_32 P1(uint_32 arg);
void CF(uint_256 V, uint_512 B);
void sm3_do(uint_8* input, uint_256 output, long long size);
uint_32 endian_swap(uint_32 arg);
